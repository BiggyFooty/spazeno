<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sparez - Rezervasyon Onayı</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 0.7;
            }
            70% {
                transform: scale(1.2);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="confirmation-page">
    <div class="app-shell">
        <!-- Header -->
        <div class="header">
            <a href="home.html" class="back-button">
                <i class="fas fa-chevron-left"></i> Ana Sayfaya Dön
            </a>
            <div style="flex: 1; text-align: center;">
                <h1 style="font-size: var(--font-size-lg);">Rezervasyon Onayı</h1>
            </div>
            <a href="user-profile.html" style="width: 40px; height: 40px; border-radius: 50%; background-color: #F5F5F5; display: flex; align-items: center; justify-content: center; text-decoration: none; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); transition: all 0.3s ease; position: relative; overflow: hidden;">
                <i class="fas fa-user" style="color: var(--primary-color);"></i>
                <div class="profile-pulse" style="position: absolute; width: 100%; height: 100%; border-radius: 50%; border: 2px solid var(--primary-color); opacity: 0; animation: pulse 2s infinite;"></div>
            </a>
        </div>

        <!-- Confirmation Content -->
        <div class="container" style="text-align: center; padding: var(--spacing-xl) var(--spacing-lg);">
            <div style="margin-bottom: var(--spacing-xl);">
                <div style="width: 80px; height: 80px; background-color: var(--success-color); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-lg);">
                    <i class="fas fa-check" style="color: white; font-size: 40px;"></i>
                </div>
                <h1 style="font-size: var(--font-size-xl); margin-bottom: var(--spacing-md);">Rezervasyon Onaylandı!</h1>
                <p style="color: var(--text-muted); margin-bottom: var(--spacing-lg);">Otel spa randevunuz başarıyla oluşturuldu.</p>
            </div>

            <!-- Booking Details -->
            <div class="card" style="text-align: left; margin-bottom: var(--spacing-xl);">
                <div style="padding: var(--spacing-lg);">
                    <h2 style="font-size: var(--font-size-lg); margin-bottom: var(--spacing-md);">Rezervasyon Detayları</h2>
                    
                    <div style="margin-bottom: var(--spacing-md);">
                        <h3 style="font-size: var(--font-size-md); margin-bottom: var(--spacing-xs);">Hizmet</h3>
                        <p style="font-size: var(--font-size-md); font-weight: 500;" id="service-name"></p>
                    </div>
                    
                    <div style="margin-bottom: var(--spacing-md);">
                        <h3 style="font-size: var(--font-size-md); margin-bottom: var(--spacing-xs);">Otel Spa</h3>
                        <p style="font-size: var(--font-size-md); font-weight: 500;" id="hotel-name"></p>
                    </div>
                    
                    <div style="margin-bottom: var(--spacing-md);">
                        <h3 style="font-size: var(--font-size-md); margin-bottom: var(--spacing-xs);">Tarih & Saat</h3>
                        <p style="font-size: var(--font-size-md); font-weight: 500;" id="booking-datetime"></p>
                    </div>
                    
                    <div style="margin-bottom: var(--spacing-md);">
                        <h3 style="font-size: var(--font-size-md); margin-bottom: var(--spacing-xs);">Konum</h3>
                        <p style="font-size: var(--font-size-md); font-weight: 500;" id="location-name"></p>
                        <p style="font-size: var(--font-size-sm); color: var(--text-muted);" id="location-address"></p>
                    </div>
                    
                    <div>
                        <h3 style="font-size: var(--font-size-md); margin-bottom: var(--spacing-xs);">Rezervasyon Kodu</h3>
                        <p style="font-size: var(--font-size-md); font-weight: 500;" id="booking-id"></p>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div style="margin-bottom: var(--spacing-xl);">
                <a href="calendar.html" class="btn btn-primary btn-block" style="margin-bottom: var(--spacing-md);">Takvimde Görüntüle</a>
                <a href="home.html" class="btn btn-secondary btn-block">Ana Sayfaya Dön</a>
            </div>

            <!-- Additional Info -->
            <div style="margin-bottom: var(--spacing-xl);">
                <p style="font-size: var(--font-size-sm); color: var(--text-muted); margin-bottom: var(--spacing-md);">Onay e-postası ve SMS'i gönderildi.</p>
                <p style="font-size: var(--font-size-sm); color: var(--text-muted);">Değişiklik yapmak mı istiyorsunuz? Randevunuzu planlanan zamandan 24 saat öncesine kadar yeniden planlayabilir veya iptal edebilirsiniz.</p>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <a href="home.html" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                <span>Ana Sayfa</span>
            </a>
            <a href="booking.html" class="nav-item active" data-page="booking">
                <i class="far fa-calendar"></i>
                <span>Rezervasyon</span>
            </a>
            <a href="services.html" class="nav-item" data-page="services">
                <i class="fas fa-spa"></i>
                <span>Hizmetler</span>
            </a>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script src="js/hotel-data.js"></script>
    <script src="js/loading-animation.js"></script>
    <script src="js/booking-data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get booking details from URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            
            // Get booking details from localStorage as backup
            const bookingData = getBookingData() || {};
            
            // Combine URL parameters with localStorage data, prioritizing URL parameters
            const bookingDetails = {
                service: urlParams.get('service') || bookingData.service || '',
                hotel: urlParams.get('hotel') || bookingData.hotel || '',
                date: urlParams.get('date') || bookingData.date || '',
                fullDate: urlParams.get('fullDate') || bookingData.fullDate || '',
                time: urlParams.get('time') || bookingData.time || '',
                gender: urlParams.get('gender') || bookingData.gender || '',
                bookingId: urlParams.get('bookingId') || bookingData.bookingId || '',
                timestamp: urlParams.get('timestamp') || bookingData.timestamp || ''
            };
            
            // Generate booking ID if not provided
            if (!bookingDetails.bookingId) {
                bookingDetails.bookingId = 'SPZ-' + Math.floor(10000 + Math.random() * 90000);
            }
            
            // Set service name
            const serviceElement = document.getElementById('service-name');
            if (serviceElement && bookingDetails.service) {
                serviceElement.textContent = bookingDetails.service;
            }
            
            // Set booking date and time
            const dateElement = document.getElementById('booking-datetime');
            if (dateElement && bookingDetails.date && bookingDetails.time) {
                const year = new Date().getFullYear();
                dateElement.textContent = `${bookingDetails.date} ${year}, ${bookingDetails.time}`;
                console.log('Setting date and time:', `${bookingDetails.date} ${year}, ${bookingDetails.time}`);
            }
            
            // Set hotel name and location
            if (bookingDetails.hotel) {
                const hotelElement = document.getElementById('hotel-name');
                const locationNameElement = document.getElementById('location-name');
                const locationAddressElement = document.getElementById('location-address');
                
                // Find the hotel in the data
                const hotels = window.hotelData || [];
                const selectedHotel = hotels.find(h => h.sube_adi === bookingDetails.hotel);
                
                if (selectedHotel) {
                    if (hotelElement) hotelElement.textContent = selectedHotel.sube_adi;
                    if (locationNameElement) locationNameElement.textContent = `${selectedHotel.sube_adi} Spa`;
                    if (locationAddressElement) locationAddressElement.textContent = selectedHotel.adres;
                } else {
                    if (hotelElement) hotelElement.textContent = bookingDetails.hotel;
                    if (locationNameElement) locationNameElement.textContent = `${bookingDetails.hotel} Spa`;
                    if (locationAddressElement) locationAddressElement.textContent = 'İstanbul, Türkiye';
                }
            }
            
            // Set booking ID
            const bookingIdElement = document.getElementById('booking-id');
            if (bookingIdElement && bookingDetails.bookingId) {
                bookingIdElement.textContent = bookingDetails.bookingId;
            }
            
            // Log booking details for debugging
            console.log('Booking details from URL parameters:', Object.fromEntries(urlParams.entries()));
            console.log('Booking details from localStorage:', bookingData);
            console.log('Final booking details:', bookingDetails);
        });
    </script>
</body>
</html>
